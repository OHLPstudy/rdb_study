Q. 다음 내용은 전자상거래 시스템에서 주문 처리를 다룬 간단한 처리 흐름입니다.

아래 흐름에서 트랜잭션을 부적절하게 사용한 부분을 찾아, 적절하게 개선된 절차와 그 이유를 작성해주세요.

```text
[주문 처리 절차 (기존 설계)]
1. 처리 시작
2. 사용자 로그인 확인
3. 장바구니 상품 목록 검증
4. 재고 수량 확인

=> 데이터베이스 커넥션 생성
=> 트랜잭션 시작

5. 결제 게이트웨이 API 호출
6. 결제 성공 여부 확인
7. 주문 정보 DB 저장
8. 주문 상세 항목(DB 저장)
9. 결제 결과 DB 저장
10. 재고 차감

<= 트랜잭션 종료(COMMIT)
<= 데이터베이스 커넥션 반납

11. 결제 성공 알림 이메일 발송
12. 이메일 발송 이력 DB 저장
13. 처리 완료
```